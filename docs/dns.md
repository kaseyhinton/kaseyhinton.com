# DNS

### Dynamic DNS with Cloudflare

My example was on ubuntu 22 which ships with ddclient 3.9 so its likely easier with the newer version that ships on 24

Create a DNS record for the domain you are using
Type: A
Name: test
IPv4 address: 1.1.1.1
Proxy status: OFF
TTL: 5 min

If using ddclient 3.11 or higher you can generate a token like this

```
Zone — DNS — Edit
Zone — Zone — Read
Zone Resources: Include — Specific Zone
```

otherwise if you are stuck on ddclient 3.9 you will need to use your cloudflare global token

install ddclient

```
sudo apt update && sudo apt install ddclient
```

edit the config

#### Config for 3.9

```
# Configuration file for ddclient generated by debconf
#
# /etc/ddclient.conf

protocol=cloudflare \
use=web \
web=ifconfig.me \
ssl=yes \
ttl=1 \
zone=mydomain.com \
login=mylogin@gmail.com \
server=api.cloudflare.com/client/v4 \
password='myglobaltoken' \
mysubdomain.mydomain.com
```

#### Config for 3.11

notice omission of user which will default to token and the password will be an api token instead of a global token

```
# Configuration file for ddclient generated by debconf
#
# /etc/ddclient.conf

protocol=cloudflare \
use=web \
web=ifconfig.me \
ssl=yes \
ttl=1 \
zone=mydomain.com \
server=api.cloudflare.com/client/v4 \
password='mytokenwithzones' \
mysubdomain.mydomain.com
```

restart the client

```
sudo service ddclient restart
```

check logs

```
cat /var/log/syslog
```

if you run into issues you can debug by running these commands

First delete the ddclient cache if it exists

```
sudo rm /var/cache/ddclient/ddclient.cache
```

Run ddclient in verbose/debug mode

```
sudo ddclient -daemon=0 -debug -verbose -noquiet
```
